{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Contact - Foodie Heaven Restaurant</title>
    <link rel="icon" type="image/png" href="{% static 'restlogo.png' %}">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@300;400;500;600&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
        }
         /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #2563EB, #DB2777);
        }
        
        h1, h2, h3 {
            font-family: 'Playfair Display', serif;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav id="navbar" class="fixed w-full z-50 transition-all duration-300 py-4 bg-white shadow-md">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center">
                <div class="text-4xl font-bold text-crimson-">
                    <i class="fas fa-utensils text-pink-500 mr-2"></i>
                    FOODIE HEAVEN ADMIN
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="{% url 'admin_dashboard' %}" class="text-pink-700 hover:text-blue-500 transition">Dashboard</a>
                    <a href="{% url 'index'%}" class="text-pink-700 hover:text-blue-500 transition">View Website</a>
                    <button id="logout-btn" class="text-pink-700 hover:text-blue-500 transition">
                        <i class="fas fa-sign-out-alt mr-2"></i>Logout
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Manage Contact Section -->
    <section class="py-20 mt-16">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold mb-8">Manage Contact Information</h2>
            
            <div class="grid md:grid-cols-2 gap-8">
                <!-- Contact Information -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-semibold mb-4">Contact Information</h3>
                    
                    <form id="contact-form">
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">Address</label>
                            <input type="text" id="address" required class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-blue-500" value="2/4, Dancy Nagar, Velacherry">
                        </div>
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">Phone</label>
                            <input type="tel" id="phone" required class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-blue-500" value="+91 7397527787">
                        </div>
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">Email</label>
                            <input type="email" id="email" required class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-blue-500" value="foodieheaven@gmail.com">
                        </div>
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">Opening Hours</label>
                            <div class="grid grid-cols-2 gap-2">
                                <div>
                                    <label class="block text-gray-600 text-sm">Monday - Thursday</label>
                                    <input type="text" id="hours-mon-thu" required class="w-full px-3 py-1 border rounded focus:outline-none focus:border-blue-500" value="5PM - 10PM">
                                </div>
                                <div>
                                    <label class="block text-gray-600 text-sm">Friday - Saturday</label>
                                    <input type="text" id="hours-fri-sat" required class="w-full px-3 py-1 border rounded focus:outline-none focus:border-blue-500" value="5PM - 11PM">
                                </div>
                                <div class="col-span-2">
                                    <label class="block text-gray-600 text-sm">Sunday</label>
                                    <input type="text" id="hours-sun" required class="w-full px-3 py-1 border rounded focus:outline-none focus:border-blue-500" value="5PM - 11PM">
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded transition">
                            Save Changes
                        </button>
                    </form>
                    
                    <div id="contact-success" class="mt-4 text-center text-green-600 hidden">
                        <i class="fas fa-check-circle"></i>
                        <p>Contact information updated successfully!</p>
                    </div>
                </div>
                
                <!-- Contact Messages -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-semibold mb-4">Contact Messages</h3>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full table-auto">
                            <thead>
                                <tr class="bg-gray-100">
                                    <th class="px-2 py-2 text-left">Name</th>
                                    <th class="px-2 py-2 text-left">Email</th>
                                    <th class="px-2 py-2 text-left">Subject</th>
                                    <th class="px-2 py-2 text-left">Date</th>
                                    <th class="px-2 py-2 text-left">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="messages-table-body">
                                <!-- Messages will be loaded here dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- View Message Modal -->
    <div id="message-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold">Message Details</h3>
                <button id="close-message-modal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="message-details">
                <!-- Message details will be loaded here -->
            </div>
            
            <div class="flex justify-end mt-6">
                <button id="close-message-btn" class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded transition">
                    Close
                </button>
            </div>
        </div>
    </div>

    <script>
        // Sample contact messages data (in a real app, this would come from a database)
        const messagesData = [
            {
                id: 1,
                name: "John Doe",
                email: "john@example.com",
                subject: "Reservation Inquiry",
                message: "I would like to make a reservation for 4 people on July 20th at 7 PM. Please let me know if this is available.",
                date: "2025-07-10"
            },
            {
                id: 2,
                name: "Jane Smith",
                email: "jane@example.com",
                subject: "Menu Question",
                message: "Do you have any gluten-free options on your menu? My friend has celiac disease and we'd like to visit your restaurant.",
                date: "2025-07-11"
            },
            {
                id: 3,
                name: "Robert Johnson",
                email: "robert@example.com",
                subject: "Private Event",
                message: "I'm planning a birthday party for about 20 people. Do you offer private dining options? What would be the cost per person?",
                date: "2025-07-12"
            }
        ];
        
        // Check if admin is logged in
        document.addEventListener('DOMContentLoaded', function() {
            const isLoggedIn = localStorage.getItem('isAdminLoggedIn');
            
            if (isLoggedIn !== 'true') {
                // Redirect to login page if not logged in
                window.location.href = 'admin_login.html';
            } else {
                // Load messages
                loadMessages();
            }
        });
        
        // Logout functionality
        document.getElementById('logout-btn').addEventListener('click', function() {
            localStorage.removeItem('isAdminLoggedIn');
            window.location.href = 'admin_login.html';
        });
        
        // Load messages
        function loadMessages() {
            const tableBody = document.getElementById('messages-table-body');
            
            if (messagesData.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="5" class="px-4 py-8 text-center text-gray-500">No messages found</td></tr>';
                return;
            }
            
            tableBody.innerHTML = messagesData.map(message => `
                <tr class="border-b">
                    <td class="px-2 py-2">${message.name}</td>
                    <td class="px-2 py-2">${message.email}</td>
                    <td class="px-2 py-2">${message.subject}</td>
                    <td class="px-2 py-2">${message.date}</td>
                    <td class="px-2 py-2">
                        <button class="view-message text-blue-500 hover:text-blue-700 mr-2" data-id="${message.id}">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="delete-message text-red-500 hover:text-red-700" data-id="${message.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
            
            // Add event listeners to action buttons
            document.querySelectorAll('.view-message').forEach(button => {
                button.addEventListener('click', function() {
                    const messageId = parseInt(this.getAttribute('data-id'));
                    viewMessage(messageId);
                });
            });
            
            document.querySelectorAll('.delete-message').forEach(button => {
                button.addEventListener('click', function() {
                    const messageId = parseInt(this.getAttribute('data-id'));
                    deleteMessage(messageId);
                });
            });
        }
        
        // View message details
        function viewMessage(messageId) {
            const message = messagesData.find(m => m.id === messageId);
            
            if (message) {
                const detailsHtml = `
                    <div class="space-y-4">
                        <div class="flex justify-between">
                            <span class="font-semibold">From:</span>
                            <span>${message.name} (${message.email})</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="font-semibold">Subject:</span>
                            <span>${message.subject}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="font-semibold">Date:</span>
                            <span>${message.date}</span>
                        </div>
                        <div>
                            <span class="font-semibold">Message:</span>
                            <p class="mt-1">${message.message}</p>
                        </div>
                    </div>
                `;
                
                document.getElementById('message-details').innerHTML = detailsHtml;
                document.getElementById('message-modal').classList.remove('hidden');
            }
        }
        
        // Delete message
        function deleteMessage(messageId) {
            if (confirm('Are you sure you want to delete this message?')) {
                const index = messagesData.findIndex(m => m.id === messageId);
                
                if (index !== -1) {
                    messagesData.splice(index, 1);
                    loadMessages();
                }
            }
        }
        
        // Save contact form
        document.getElementById('contact-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // In a real app, this would save to a database
            // For this demo, we'll just show a success message
            
            const successDiv = document.getElementById('contact-success');
            successDiv.classList.remove('hidden');
            
            // Hide success message after 3 seconds
            setTimeout(() => {
                successDiv.classList.add('hidden');
            }, 3000);
        });
        
        // Close message modal
        document.getElementById('close-message-modal').addEventListener('click', function() {
            document.getElementById('message-modal').classList.add('hidden');
        });
        
        document.getElementById('close-message-btn').addEventListener('click', function() {
            document.getElementById('message-modal').classList.add('hidden');
        });
    </script>
</body>
</html>